## 練習問題

#### 算数

整数リテラル、加算、減算の全てを使って 42 に評価される式を書いてみよう。

<div class="solution">
この練習問題は Scala のコードを書くのに慣れるためのものです。色々な解答が可能ですが、1つの例として以下のように書けます。

```tut:book
1 + 43 - 2
```
</div>


#### 文字列の追加

`++` メソッドを使って 2つの文字列を連結してみよう (文字列の**追加**とも言います)。適当な式を普通のメソッド呼び出しスタイルと演算子スタイルそれぞれを使って書いてみよう。

<div class="solution">
こんな感じでいいと思います。

```tut:book
"It is a truth ".++("universally acknowledged")
"It is a truth " ++ "universally acknowledged"
```
</div>

#### 優先順位

数学では演算子には**優先順位**があることを習いました。例えば、`1 + 2 * 3` という式があるとき、乗算を先に行ってから加算を行います。Scala でもこのルールが当てはまるでしょうか?

<div class="solution">
console で色々実験してみると、Scala も標準的な演算子の優先順位に従うことが分かると思います。以下にこれを示す例を挙げます。

```tut:book
1 + 2 * 3
1 + (2 * 3)
(1 + 2) * 3
```
</div>


#### 型と値

以下に挙げた式のうちコンパイルしないのはどれでしょう? 式がコンパイルする場合は、その型は何でしょうか? どの式が実行時に失敗するでしょう?

```tut:silent
1 + 2
```

```tut:silent
"3".toInt
```

```tut:fail:silent
"Electric blue".toInt
```

```tut:silent
"Electric blue".take(1)
```

```tut:fail:silent
"Electric blue".take("blue")
```

```tut:silent
1 + ("Moonage daydream".indexOf("N"))
```

```tut:silent
1 / 1 + ("Moonage daydream".indexOf("N"))
```

```tut:fail:silent
1 / (1 + ("Moonage daydream".indexOf("N")))
```

<div class="solution">
```tut:book
1 + 2
```

この式は `Int` 型を持ち、`3` と評価されます。

```tut:book
"3".toInt
```

この式は `Int` 型を持ち、`3` と評価されます。

```tut:fail:book
"Electric blue".toInt
```

この式は `Int` 型を持ちますが、実行時に失敗します。

```tut:silent
"Electric blue".take(1)
```

この式は `String` 型を持ち、`"E"` と評価されます。

```tut:fail:book
"Electric blue".take("blue")
```

この式はコンパイル時に失敗し、そのため型を持ちません。

```tut:book
1 + ("Moonage daydream".indexOf("N"))
```

この式は `Int` 型を持ち、`0` と評価されます。

```tut:book
1 / 1 + ("Moonage daydream".indexOf("N"))
```

この式は `Int` 型を持ち、演算子の優先順位により `(1 / 1) + -1` と評価され、`0` となります。

```tut:fail:silent
1 / (1 + ("Moonage daydream".indexOf("N")))
```

この式は `Int` 型を持ちますが、ゼロによる除算のため実行時に失敗します。
</div>

#### 浮動小数点数の弱点

Double を紹介したとき、それは実数の近似値だと言いました。これは何故だと思いますか? ⅓ や π といった数を表すことを考えてみましょう。それらの数を 10進数で表すとしたらいくら容量が必要でしょうか?

<div class="solution">
`Double` が近似値であるのは、コンピューターの有限なメモリーに収める必要があるからです。1つの `Double` は、64ビットの容量を取り、これは多くの桁数を保持するのに十分ですが、π のように無限に展開する数を格納することはできません。

⅓ という数も 10進数では無限に展開します。Double は 2進数で格納されているため、10進数なら有限の桁数で表せる数でも 2進数では有限の表現を持たない場合があります。実は、0.1 はそのような数の一例です。

一般的に、浮動小数点数が実数と同じように振る舞うと期待すると思わぬ所でひどい目に合わされます。Creative Scala を使うには事足りますが、浮動小数点数を使って帳簿管理ソフトを書いてはいけません!
</div>

#### 式の先にあるもの

今の計算モデルは、式 (プログラムのテキスト) とその型、そしてそれが評価されたときの値 (コンピューターのメモリ内に存在するもの) という 3つの要素を持ちます。これははたして十分なものでしょうか? このモデルを使って株式市場やコンピューターゲームを書くことができるでしょうか? このモデルを拡張する方法を考えてみてください。

<div class="solution">
これは自由回答の質問です。現行のモデルを拡張するいくつかの方法を考えることができます。

役に立つプログラムを書くには作用 (effect)、つまりコンピューターのメモリを超えた世界に関する何らかの変更を引き起こす能力を必要とします。例えば、画面に何か表示したり、音を出したり、他のコンピューターにメッセージを送信したりなどの作用があります。console は値を画面に表示することで自動的に何らかの作用を引き起こしてると言えます。より役に立つプログラムを書くには、それ以上の作用が必要になります。

また、私たちは今の所独自のオブジェクトやメソッドを定義したり、プログラムの中で値を再利用するすべを持ちません。例えば、プログラム中で誰かの名前を使いたいとすると、その名前を何度も繰り返して書く必要があります。**抽象化**の方法が必要で、これからその方法を見ていきます。
</div>
